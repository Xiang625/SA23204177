<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Mingming Xiang" />

<meta name="date" content="2023-12-04" />

<title>Homework Answers</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework Answers</h1>
<h4 class="author">Mingming Xiang</h4>
<h4 class="date">2023-12-04</h4>



<div id="homework-2023.09.11" class="section level1">
<h1>Homework-2023.09.11</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>Use knitr to produce at least 3 examples. For each example, texts
should mix with figures and/or tables. Better to have mathematical
formulas.</p>
<div id="answer" class="section level3">
<h3>Answer</h3>
</div>
<div id="example-1" class="section level3">
<h3>Example 1</h3>
<p><code>iris</code>
是一个数据集，分别给出了3种鸢尾花（每种各50朵）萼片的长度和宽度，花瓣的长度和宽度（以厘米为单位）测量值。</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># 直接输出数据</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>test <span class="ot">&lt;-</span> <span class="fu">head</span>(iris)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>test</span></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># 展示为表格</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(test)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># 得到Latex形式的表格</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>xtable<span class="sc">::</span><span class="fu">xtable</span>(test)</span></code></pre></div>
<pre><code>## % latex table generated in R 4.3.2 by xtable 1.8-4 package
## % Sun Dec 10 02:43:35 2023
## \begin{table}[ht]
## \centering
## \begin{tabular}{rrrrrl}
##   \hline
##  &amp; Sepal.Length &amp; Sepal.Width &amp; Petal.Length &amp; Petal.Width &amp; Species \\ 
##   \hline
## 1 &amp; 5.10 &amp; 3.50 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   2 &amp; 4.90 &amp; 3.00 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   3 &amp; 4.70 &amp; 3.20 &amp; 1.30 &amp; 0.20 &amp; setosa \\ 
##   4 &amp; 4.60 &amp; 3.10 &amp; 1.50 &amp; 0.20 &amp; setosa \\ 
##   5 &amp; 5.00 &amp; 3.60 &amp; 1.40 &amp; 0.20 &amp; setosa \\ 
##   6 &amp; 5.40 &amp; 3.90 &amp; 1.70 &amp; 0.40 &amp; setosa \\ 
##    \hline
## \end{tabular}
## \end{table}</code></pre>
</div>
<div id="example-2" class="section level3">
<h3>Example 2</h3>
<p>使用<code>ggplot2</code>进行数据可视化，例如可用<code>geom_point()</code>函数绘制散点图：</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># 将鸢尾花的类型映射给点的颜色和形状</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>fig_all <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width, <span class="at">colour=</span>Species, <span class="at">shape=</span>Species)) <span class="sc">+</span> <span class="fu">geom_point</span>()</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>fig_all</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example-3" class="section level3">
<h3>Example 3</h3>
<p>考虑对类别为<code>setosa</code>的数据进行线性回归建模，并绘制回归模型拟合线。线性回归模型为：
<span class="math display">\[
Y=\beta_0+\beta_1X
\]</span></p>
<p>我们首先筛选数据：</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>setosa <span class="ot">&lt;-</span> iris[iris<span class="sc">$</span>Species <span class="sc">==</span> <span class="st">&quot;setosa&quot;</span>,]</span></code></pre></div>
<p>可以使用<code>stst_smooth()</code>函数并设置<code>method=lm</code>向散点图中加入拟合线：</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>fig_setosa <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(setosa, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width))</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>fig_setosa <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> lm)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># 同时绘制3种类型数据的拟合线</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>fig_all <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">method =</span> lm, <span class="at">fullrange =</span> <span class="cn">TRUE</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="homework-2023.09.18" class="section level1">
<h1>Homework-2023.09.18</h1>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>利用逆变换法复现函数<code>sample</code>的部分功能:<code>replace = TRUE</code></p>
<div id="answer-1" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>mySample <span class="ot">&lt;-</span> <span class="cf">function</span>(x,n){</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>,m)<span class="sc">/</span>m</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>  cp <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(p)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>  </span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>  r <span class="ot">&lt;-</span> x[<span class="fu">findInterval</span>(u,cp)<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>  <span class="fu">return</span>(r)</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>} </span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">mySample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>,<span class="dv">2000</span>) <span class="co">#test</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="fu">table</span>(x)</span></code></pre></div>
<pre><code>## x
##   1   2   3   4   5   6 
## 332 352 332 338 322 324</code></pre>
</div>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span>, <span class="math inline">\(x\in\mathbb R\)</span>. Use the inverse transform
method to generate a random sample of size 1000 from this distribution.
Use one of the methods shown in this chapter to compare the generated
sample to the target distribution.</p>
<div id="answer-2" class="section level3">
<h3>Answer</h3>
<p>Note that <span class="math display">\[
\begin{aligned}
F(x)&amp; =\int_{-\infty}^xf(u)\mathrm{d}u  \\
&amp;=\begin{cases}&amp;\frac12\exp\left(x\right)&amp;\mathrm{if~}x&lt;0\\\\&amp;1-\frac12\exp\left(-x\right)&amp;\mathrm{if~}x\geq0&amp;\end{cases}
\\
&amp;=0.5\left[1+\mathrm{sgn}(x)\left(1-\exp(-|x|)\right)\right],
\end{aligned}
\]</span> then <span class="math display">\[
F^{-1}(p)=\begin{cases}&amp;\ln(2p)&amp;\mathrm{if~}p&lt;0.5\\\\&amp;-\ln(2(1-p))&amp;\mathrm{if~}p\geq0.5&amp;\end{cases}
\]</span></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>u)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>x[u<span class="sc">&gt;=</span><span class="fl">0.5</span>] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>u[u<span class="sc">&gt;=</span><span class="fl">0.5</span>]))</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)) <span class="co">#density histogram of sample</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">8</span>, .<span class="dv">01</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(y))) <span class="co">#density curve f(x)</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>Write a function to generate a random sample of size n from the
Beta(a, b) distribution by the acceptance-rejection method. Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed.</p>
<div id="answer-3" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>general.acc.rej <span class="ot">&lt;-</span> <span class="cf">function</span>(size, xs, df, dgen, rgen, c){</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>  acc.rej <span class="ot">&lt;-</span> <span class="cf">function</span>(size, df, rgen, dgen, c){</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>    ct <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>    n <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>    res <span class="ot">=</span> <span class="fu">numeric</span>(size)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>    <span class="cf">while</span>(n <span class="sc">&lt;=</span> size){</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>      y <span class="ot">=</span> <span class="fu">rgen</span>(<span class="dv">1</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>      u <span class="ot">=</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>      <span class="cf">if</span> (u <span class="sc">&lt;</span> <span class="fu">df</span>(y)<span class="sc">/</span><span class="fu">dgen</span>(y)<span class="sc">/</span>c){</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>        res[n] <span class="ot">=</span> y</span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a>        n <span class="ot">=</span> n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>      }</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>      ct <span class="ot">=</span> ct <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>    }</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a>    <span class="fu">return</span>(res)</span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a>  }</span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>  </span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>  </span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a>  sam <span class="ot">=</span> <span class="fu">acc.rej</span>(<span class="at">size =</span> size, <span class="at">df =</span> df, <span class="at">rgen =</span> rgen, <span class="at">dgen =</span> dgen, c)</span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>  <span class="fu">return</span>(sam)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>}</span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a>myBeta <span class="ot">&lt;-</span> <span class="cf">function</span>(size, a, b){</span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a>  rgen <span class="ot">&lt;-</span> <span class="cf">function</span>(size) <span class="fu">runif</span>(size, <span class="at">min =</span> u.min, <span class="at">max =</span> u.max)</span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a>  dgen <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">dunif</span>(x, <span class="at">min =</span> u.min, <span class="at">max =</span> u.max)</span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="cf">function</span> (x) <span class="fu">dbeta</span>(<span class="at">x =</span> x, <span class="at">shape1 =</span> a, <span class="at">shape2 =</span> b)</span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a>  </span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a>  xs <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.01</span>)</span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a>  u.max <span class="ot">=</span> <span class="fu">max</span>(xs)</span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a>  u.min <span class="ot">=</span> <span class="fu">min</span>(xs)</span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a>  y.max <span class="ot">=</span> <span class="fu">max</span>(<span class="fu">df</span>(xs))</span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a>  c <span class="ot">=</span> y.max<span class="sc">/</span>(u.max <span class="sc">-</span> u.min)</span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a>  </span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a>  sam <span class="ot">&lt;-</span> <span class="fu">general.acc.rej</span> (<span class="at">size =</span> size, <span class="at">xs =</span> xs, <span class="at">df =</span> df, <span class="at">dgen =</span> dgen, <span class="at">rgen =</span> rgen, <span class="at">c =</span> c)</span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a>  <span class="fu">hist</span>(sam, <span class="at">probability =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a>  <span class="fu">lines</span>(xs, <span class="fu">df</span>(xs))</span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a>}</span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a>a <span class="ot">=</span> <span class="dv">3</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a>b <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a>size <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="fu">myBeta</span>(<span class="at">size =</span> size, <span class="at">a =</span> a, <span class="at">b =</span> b)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>The rescaled Epanechnikov kernel is a symmetric density function
<span class="math display">\[
\begin{aligned}f_e(x)=\frac{3}{4}(1-x^2),\quad|x|\le1.\end{aligned}
\]</span> Devroye and Gyorfi give the following algorithm for simulation
from this distribution. Generate iid <span class="math inline">\(U_1\)</span>, <span class="math inline">\(U_2\)</span>, <span class="math inline">\(U_3\)</span> ∼ Uniform(−1, 1). If <span class="math inline">\(|U_3| \ge|U_2|\)</span> and <span class="math inline">\(|U_3|\ge|U_1|\)</span>, deliver <span class="math inline">\(U_2\)</span>; otherwise deliver <span class="math inline">\(U_3\)</span>. Write a function to generate random
variates from <span class="math inline">\(f_e\)</span>, and construct
the histogram density estimate of a large simulated random sample.</p>
<div id="answer-4" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>re <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  u1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  u2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>  u3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> u3</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>  i <span class="ot">&lt;-</span> (<span class="fu">abs</span>(u3)<span class="sc">&gt;=</span><span class="fu">abs</span>(u2)) <span class="sc">&amp;</span> (<span class="fu">abs</span>(u3)<span class="sc">&gt;=</span><span class="fu">abs</span>(u1))</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> u2[i]</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a>}</span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">re</span>(<span class="dv">5000</span>)</span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>) <span class="co">#density histogram of sample</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>, .<span class="dv">01</span>)</span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="fu">lines</span>(y, <span class="fl">0.75</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(x,<span class="at">bw =</span> <span class="fl">0.1</span>), <span class="at">col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-5" class="section level2">
<h2>Question 5</h2>
<p>Prove that the algorithm given in <strong>Question 4</strong>
generates variates from the density <span class="math inline">\(f_e\)</span>.</p>
<div id="answer-5" class="section level3">
<h3>Answer</h3>
<p>Note that <span class="math inline">\(F_e(x)=-\frac{1}{4}x^3+\frac{3}{4}x+\frac{1}{2}\)</span>,
thus we only need to prove<span class="math inline">\(P(X\le
x)=F(x)\)</span>.</p>
<span class="math display">\[\begin{aligned}
P(X\le x)&amp;=P(U_2\le x,|U_3|=\max\{|U_1|,|U_2|,|U_3|\})
+P(U_3\le x)-P(U_3\le x, |U_3|=\max\{|U_1|,|U_2|,|U_3|\})\\
&amp;=\int_{-1}^{x} \frac{1}{2} \int_{|u_2|}^{1} \int_{0}^{|u_3|}
\mathrm{d}u_1\mathrm{d}u_3\mathrm{d}u_2
+\frac{1}{2} (x+1)
-\int_{-1}^{x} \frac{1}{2} \int_{0}^{|u_3|}\int_{0}^{|u_3|}
\mathrm{d}u_1\mathrm{d}u_2\mathrm{d}u_3\\
&amp;=\frac{1}{4}\int_{-1}^{x}(1-u_2^2)\mathrm{d}u_2 +\frac{1}{2} (x+1)
-\frac{1}{2}\int_{-1}^{x}u_3^2\mathrm{d}u_3\\
&amp;=\frac{1}{4}(-\frac{1}{3} x^3+x+\frac{2}{3})+\frac{1}{2}
(x+1)-\frac{1}{6} (x^3+1)\\
&amp;=-\frac{1}{4} x^3+\frac{3}{4} x^2+\frac{1}{2}
\end{aligned}\]</span>
</div>
</div>
</div>
<div id="homework-2023.09.25" class="section level1">
<h1>Homework-2023.09.25</h1>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<ul>
<li><p>Proof that what value <span class="math inline">\(\rho=\frac{l}{d}\)</span> should take to minimize
the asymptotic variance of <span class="math inline">\(\hat
\pi\)</span>? (m ∼ B(n, p),using δ method)</p></li>
<li><p>Take three different values of ρ (0 ≤ ρ ≤ 1, including <span class="math inline">\(\rho_\min\)</span>) and use Monte Carlo simulation
to verify your answer. (n = 106, Number of repeated simulations K =
100)</p></li>
</ul>
<div id="answer-6" class="section level3">
<h3>Answer</h3>
<p>Note that <span class="math inline">\(\hat\theta=\frac{m}{n\rho}\)</span> is an unbiased
estimator of <span class="math inline">\(\frac{2}{\pi}\)</span> and
<span class="math inline">\(p=\frac{2\rho}{\pi}\)</span>, then</p>
<p><span class="math display">\[
Var(\hat\theta)=\frac{Var(m)}{n^2\rho^2}=\frac{p(1-p)}{n\rho^2}
=\frac{2 (\pi-2\rho)}{n\pi^2\rho}.
\]</span></p>
<p>It is easy to show that the minimum located at <span class="math inline">\(\rho=1\)</span>(<span class="math inline">\(0&lt;\rho\le1\)</span>).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>K <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="fl">1e6</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>rho_test <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.6</span>,<span class="dv">1</span>)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>Est <span class="ot">&lt;-</span> <span class="cf">function</span>(n, rho) {</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>  theta <span class="ot">=</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">runif</span>(n, <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>  <span class="co"># cross is a vector of true/false. Take the mean to find a proportion</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>  cross <span class="ot">=</span> x <span class="sc">&lt;=</span> rho<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sin</span>(theta)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(cross))</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>}</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="cf">for</span> (rho <span class="cf">in</span> rho_test){</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>  E <span class="ot">=</span> <span class="fu">c</span>()</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K){</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a>    E[k] <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>rho<span class="sc">/</span><span class="fu">Est</span>(n, rho)</span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a>  }</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;rho =&quot;</span>,rho,<span class="st">&quot;Var =&quot;</span>,<span class="fu">var</span>(E)))</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;rho = 0.3 Var = 4.93605090405857e-05&quot;
## [1] &quot;rho = 0.6 Var = 1.63953441231448e-05&quot;
## [1] &quot;rho = 1 Var = 6.2825368451272e-06&quot;</code></pre>
</div>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration of <span class="math display">\[
\theta=\int_0^1e^xdx
\]</span> Now consider the antithetic variate approach. Compute <span class="math inline">\(Cov(e^U,e^{1-U})\)</span> and <span class="math inline">\(Var(e^U+e^{1-U})\)</span>, where <span class="math inline">\(U\sim\text{Uniform}(0,1)\)</span>. What is the
percent reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
<div id="answer-7" class="section level3">
<h3>Answer</h3>
<p><span class="math inline">\(Cov(e^U,e^{1-U})=3e-e^2-1\doteq-0.2342106\)</span></p>
<p><span class="math inline">\(Var(e^U+e^{1-U})=2Var(e^U)+2Cov(e^U,e^{1-U})={e^2-1}-2(e-1)^2+2(3e-e^2-1)=-3e^2+10e-5\)</span></p>
<p><span class="math display">\[
\begin{aligned}
nVar(\hat{\theta}_{c^*})&amp;=Var(e^U)-\frac{[Cov(e^U,e^{1-U})]^2}{Var(e^{1-U})}\\
&amp;\doteq0.2420356-(-0.2342106)^2/0.2420356\\
&amp;=0.01539702
\end{aligned}
\]</span></p>
<p>Then <span class="math inline">\(100(1-0.01539702/0.2420356) =
93.63853\%\)</span>.</p>
</div>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach
and by the simple Monte Carlo method. Compute an empirical estimate of
the percent reduction in variance using the antithetic variate. Compare
the result with the theoretical value from Exercise 5.6.</p>
<div id="answer-8" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="fl">1e5</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>e <span class="ot">=</span> <span class="fu">exp</span>(<span class="dv">1</span>)</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>a <span class="ot">=</span> <span class="sc">-</span>(<span class="dv">3</span><span class="sc">*</span>e<span class="sc">-</span>e<span class="sc">^</span><span class="dv">2-1</span>)<span class="sc">/</span>((e<span class="sc">^</span><span class="dv">2-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>(e<span class="dv">-1</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>T1 <span class="ot">&lt;-</span> <span class="fu">exp</span>(U) <span class="co">#simple MC</span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>T2 <span class="ot">&lt;-</span> <span class="fu">exp</span>(U) <span class="sc">+</span> a <span class="sc">*</span> (e<span class="sc">^</span>(<span class="dv">1</span><span class="sc">-</span>U) <span class="sc">-</span> (e<span class="dv">-1</span>)) <span class="co">#controlled</span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(T1), <span class="fu">mean</span>(T2), <span class="fu">exp</span>(<span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>) </span></code></pre></div>
<pre><code>## [1] 1.717580 1.718617 1.718282</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">sd</span>(T1)<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="fu">sd</span>(T2)<span class="sc">/</span><span class="fu">sqrt</span>(n))</span></code></pre></div>
<pre><code>## [1] 0.0015572196 0.0003920023</code></pre>
</div>
</div>
</div>
<div id="homework-2023.10.09" class="section level1">
<h1>Homework-2023.10.09</h1>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<p>Prove that if <span class="math inline">\(g\)</span> is a continuous
function on <span class="math inline">\((a_0,a_k)\)</span>, then <span class="math inline">\(Var(\hat{\theta}^{S})/Var(\hat{\theta}^{M})\to
0\)</span> as <span class="math inline">\(a_i-a_{i-1}\to 0\)</span> for
all <span class="math inline">\(i=1,\dots,k\)</span>.</p>
<div id="answer-9" class="section level3">
<h3>Answer</h3>
<p>We only need to prove <span class="math inline">\(Var(\hat{\theta}^S)/Var(\hat{\theta}_I)\to0\)</span>
<span class="math display">\[
\begin{align}
Var(\theta_I)&amp;=\frac{1}{k}\sum_{i=1}^{k}\left [
\sigma_i^2+\theta_i^2- \frac{1}{k^2}(\sum_{j=1}^{k} \theta_j )^2 \right
] \\
&amp;= \mathbb{E}\left [  g(U)^2 \right ] -\frac{1}{k^2}(\sum_{j=1}^{k}
\theta_j )^2\\
&amp;=Var(g(U))
\end{align}
\]</span> <span class="math display">\[
\begin{align}
\frac{Var(\hat{\theta}^S )}{Var(\theta_I)}
&amp;=\frac{\frac1{Mk}\sum_{i=1}^k\sigma_i^2}
{\frac{1}{M}Var(g(U))} \\
&amp;=\frac{k\mathbb{E}\left [  g(U)^2 \right ]-\sum\theta_i^2}
{Var(g(U))}\\
\end{align}
\]</span> Note <span class="math inline">\(\sum a_i^2\le
k\mathbb{E}\left [ g(U)^2 \right ]\le\sum b_i^2\)</span> and <span class="math inline">\(b_i-a_i\to0\)</span>, then</p>
<p><span class="math display">\[
\sum(a_i^2-\theta_i^2)\le k\mathbb{E}\left [  g(U)^2 \right
]-\sum\theta_i^2\le\sum(b_i^2-\theta_i^2).
\]</span></p>
<p>Thus <span class="math inline">\(k\mathbb{E}\left [ g(U)^2 \right
]-\sum\theta_i^2\to 0\)</span>.</p>
</div>
</div>
<div id="question-2-5.13" class="section level2">
<h2>Question 2 (5.13)</h2>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[\begin{align*}
g(x)=\frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2}, \quad x&gt;1.
\end{align*}\]</span></p>
<div id="answer-10" class="section level3">
<h3>Answer</h3>
<p><span class="math inline">\(f_1(x)=\frac{1}{x^2}\)</span></p>
<p><span class="math inline">\(f_2(x)=e^{1-x}\)</span></p>
<p>I think <span class="math inline">\(f_2\)</span> is better, because
it corresponds to the most nearly constant ratio <span class="math inline">\(g(x)/f(x)\)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>}</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>f1g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">g</span>(x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">/</span>pi<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a>f2g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">g</span>(x)<span class="sc">/</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="fu">curve</span>(f1g, <span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">10</span>)</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="fu">curve</span>(f2g, <span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">10</span>,<span class="at">add=</span>T,<span class="at">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-3-5.14" class="section level2">
<h2>Question 3 (5.14)</h2>
<p>Which of your two importance functions should produce the smaller
variance in estimating <span class="math display">\[\begin{align*}
\int_{1}^{\infty} \frac{x^{2}}{\sqrt{2 \pi}} e^{-x^{2} / 2} \text{d} x
\end{align*}\]</span> by importance sampling? Explain.</p>
<div id="answer-11" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(<span class="dv">1000</span>,<span class="dv">1</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>theta.hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">f2g</span>(x))</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>theta.hat</span></code></pre></div>
<pre><code>## [1] 0.4089316</code></pre>
</div>
</div>
<div id="qustion-4-5.15" class="section level2">
<h2>Qustion 4 (5.15)</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10.</p>
<div id="answer-12" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co"># M &lt;- 1000</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="co"># k &lt;- 10</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co"># N &lt;- 50</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co"># T2 &lt;- numeric(k)</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co"># est &lt;- matrix(0, N, 2)</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co"># for (i in 1:N) {</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#   x &lt;- rexp(1000,1) + 1</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#   est[i, 1] &lt;- mean(f2g(x))</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#   for(j in 1:k) T2[j]&lt;-mean(g(runif(M/k,(j-1)/k,j/k)))</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#   est[i, 2] &lt;- mean(T2)</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co"># round(apply(est,2,mean),4)</span></span></code></pre></div>
</div>
</div>
<div id="question-5-6.5" class="section level2">
<h2>Question 5 (6.5)</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but
the sample data are non-normal. Then the probability that the confidence
interval covers the mean is not necessarily equal to 0.95. Use a Monte
Carlo experiment to estimate the coverage probability of the t-interval
for random samples of <span class="math inline">\(\chi^2(2)\)</span>
data with sample size n = 20. Compare your t-interval results with the
simulation results in Example 6.4. (The t-interval should be more robust
to departures from normality than the interval for variance.)</p>
<div id="answer-13" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e5</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a>reject <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">2</span>)</span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a>  mu.hat <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a>  sigma.hat <span class="ot">=</span> <span class="fu">var</span>(x)</span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a>  reject[i] <span class="ot">&lt;-</span> (mu.hat<span class="sc">&lt;=</span><span class="dv">2</span><span class="sc">-</span>sigma.hat<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.9755</span>,m<span class="dv">-1</span>)) <span class="sc">||</span> (mu.hat<span class="sc">&gt;=</span><span class="dv">2</span><span class="sc">+</span>sigma.hat<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.9755</span>,m<span class="dv">-1</span>))</span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a>} </span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(reject))</span></code></pre></div>
<pre><code>## [1] 0.00103</code></pre>
</div>
</div>
<div id="question-6-6.a" class="section level2">
<h2>Question 6 (6.A)</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type
I error rate of the t-test is approximately equal to the nominal
significance level <span class="math inline">\(\alpha\)</span>, when the
sampled population is non-normal. The t-test is robust to mild
departures from normality. Discuss the simulation results for the cases
where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform<span class="math inline">\((0,2)\)</span>, and (iii) Exponential<span class="math inline">\((\text{rate} = 1)\)</span>. In each case, test
<span class="math inline">\(H_0 : \mu = \mu_0\)</span> vs <span class="math inline">\(H_1 : \mu \ne \mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform<span class="math inline">\((0,2)\)</span>, and Exponential<span class="math inline">\((1)\)</span>, respectively.</p>
<div id="answer-14" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>m <span class="ot">=</span> <span class="fl">1e5</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="co"># chi(1)</span></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>reject <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n,<span class="dv">1</span>)</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>  mu.hat <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>  sigma.hat <span class="ot">=</span> <span class="fu">var</span>(x)</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>  reject[i] <span class="ot">&lt;-</span> (mu.hat<span class="sc">&lt;=</span><span class="dv">1</span><span class="sc">-</span>sigma.hat<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.9755</span>,m<span class="dv">-1</span>)) <span class="sc">||</span> (mu.hat<span class="sc">&gt;=</span><span class="dv">1</span><span class="sc">+</span>sigma.hat<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.9755</span>,m<span class="dv">-1</span>))</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>} </span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(reject))</span></code></pre></div>
<pre><code>## [1] 0.08118</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># U(0,2)</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  mu.hat <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>  sigma.hat <span class="ot">=</span> <span class="fu">var</span>(x)</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>  reject[i] <span class="ot">&lt;-</span> (mu.hat<span class="sc">&lt;=</span><span class="dv">1</span><span class="sc">-</span>sigma.hat<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.9755</span>,m<span class="dv">-1</span>)) <span class="sc">||</span> (mu.hat<span class="sc">&gt;=</span><span class="dv">1</span><span class="sc">+</span>sigma.hat<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.9755</span>,m<span class="dv">-1</span>))</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>} </span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(reject))</span></code></pre></div>
<pre><code>## [1] 0.03056</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="co"># Exp(1)</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n)</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>  mu.hat <span class="ot">=</span> <span class="fu">mean</span>(x)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>  sigma.hat <span class="ot">=</span> <span class="fu">var</span>(x)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>  reject[i] <span class="ot">&lt;-</span> (mu.hat<span class="sc">&lt;=</span><span class="dv">1</span><span class="sc">-</span>sigma.hat<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.9755</span>,m<span class="dv">-1</span>)) <span class="sc">||</span> (mu.hat<span class="sc">&gt;=</span><span class="dv">1</span><span class="sc">+</span>sigma.hat<span class="sc">*</span><span class="fu">qt</span>(<span class="fl">0.9755</span>,m<span class="dv">-1</span>))</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>} </span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(reject))</span></code></pre></div>
<pre><code>## [1] 0.0601</code></pre>
</div>
</div>
</div>
<div id="homework-2023.10.16" class="section level1">
<h1>Homework-2023.10.16</h1>
<div id="question-1-4" class="section level2">
<h2>Question 1</h2>
<p>m=1000个假设，前95%原假设成立，后5%对立假设成立。原假设下p-value<span class="math inline">\(\sim U(0,1)\)</span>； 对立假设下p-value<span class="math inline">\(\sim Beta(0.1,1)\)</span>.</p>
<p>应用Bonferroni校正与B-H校正于生成的p-value(<code>p.adjust</code>)，得到校正的p-value，与<span class="math inline">\(\alpha=0.1\)</span>比较是否拒绝原假设。</p>
<div id="answer-15" class="section level3">
<h3>Answer</h3>
<p>基于M=1000次模拟，可估计FWER，FDR，TPR输出到表中：</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>M <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>m1 <span class="ot">=</span> <span class="dv">950</span></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>m2 <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>FWER.Bon <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>FDR.Bon <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>TPR.Bon <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>FWER.BH <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>FDR.BH <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>TPR.BH <span class="ot">&lt;-</span> <span class="fu">numeric</span>(M)</span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M){</span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m1)</span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(m2,<span class="fl">0.1</span>,<span class="dv">1</span>)</span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">c</span>(x1,x2)</span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a>  </span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>  <span class="co"># Bonferroni校正</span></span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a>  p.adj1 <span class="ot">=</span> <span class="fu">p.adjust</span>(x, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a>  <span class="co"># BH</span></span>
<span id="cb38-22"><a href="#cb38-22" tabindex="-1"></a>  p.adj2 <span class="ot">=</span> <span class="fu">p.adjust</span>(x, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb38-23"><a href="#cb38-23" tabindex="-1"></a>  </span>
<span id="cb38-24"><a href="#cb38-24" tabindex="-1"></a>  FWER.Bon[i] <span class="ot">=</span> <span class="fu">sum</span>(p.adj1[<span class="dv">1</span><span class="sc">:</span>m1]<span class="sc">&lt;</span>alpha)<span class="sc">&gt;=</span><span class="dv">1</span></span>
<span id="cb38-25"><a href="#cb38-25" tabindex="-1"></a>  FDR.Bon[i] <span class="ot">=</span> <span class="fu">sum</span>(p.adj1[<span class="dv">1</span><span class="sc">:</span>m1]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="fu">sum</span>(p.adj1<span class="sc">&lt;</span>alpha)</span>
<span id="cb38-26"><a href="#cb38-26" tabindex="-1"></a>  TPR.Bon[i] <span class="ot">=</span> <span class="fu">sum</span>(p.adj1[(m1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]<span class="sc">&lt;</span>alpha)<span class="sc">/</span>m2</span>
<span id="cb38-27"><a href="#cb38-27" tabindex="-1"></a>  FWER.BH[i] <span class="ot">=</span> <span class="fu">sum</span>(p.adj2[<span class="dv">1</span><span class="sc">:</span>m1]<span class="sc">&lt;</span>alpha)<span class="sc">&gt;=</span><span class="dv">1</span></span>
<span id="cb38-28"><a href="#cb38-28" tabindex="-1"></a>  FDR.BH[i] <span class="ot">=</span> <span class="fu">sum</span>(p.adj2[<span class="dv">1</span><span class="sc">:</span>m1]<span class="sc">&lt;</span>alpha)<span class="sc">/</span><span class="fu">sum</span>(p.adj2<span class="sc">&lt;</span>alpha)</span>
<span id="cb38-29"><a href="#cb38-29" tabindex="-1"></a>  TPR.BH[i] <span class="ot">=</span> <span class="fu">sum</span>(p.adj2[(m1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m]<span class="sc">&lt;</span>alpha)<span class="sc">/</span>m2</span>
<span id="cb38-30"><a href="#cb38-30" tabindex="-1"></a>}</span>
<span id="cb38-31"><a href="#cb38-31" tabindex="-1"></a></span>
<span id="cb38-32"><a href="#cb38-32" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb38-33"><a href="#cb38-33" tabindex="-1"></a>  <span class="sc">~</span>Method,<span class="sc">~</span>FWER, <span class="sc">~</span>FDR, <span class="sc">~</span>TPR,</span>
<span id="cb38-34"><a href="#cb38-34" tabindex="-1"></a>  <span class="st">&quot;Bonferroni&quot;</span>, <span class="fu">mean</span>(FWER.Bon), <span class="fu">mean</span>(FDR.Bon), <span class="fu">mean</span>(TPR.Bon),</span>
<span id="cb38-35"><a href="#cb38-35" tabindex="-1"></a>  <span class="st">&quot;BH&quot;</span>, <span class="fu">mean</span>(FWER.BH), <span class="fu">mean</span>(FDR.BH), <span class="fu">mean</span>(TPR.BH)</span>
<span id="cb38-36"><a href="#cb38-36" tabindex="-1"></a>)</span>
<span id="cb38-37"><a href="#cb38-37" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">FWER</th>
<th align="right">FDR</th>
<th align="right">TPR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bonferroni</td>
<td align="right">0.081</td>
<td align="right">0.0042497</td>
<td align="right">0.40388</td>
</tr>
<tr class="even">
<td align="left">BH</td>
<td align="right">0.926</td>
<td align="right">0.0946987</td>
<td align="right">0.56750</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>Compare the mean bootstrap bias and bootstrap standard error with
theoretical ones. Comment on the results.</p>
<div id="answer-16" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> N){</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rexp</span>(n,<span class="dv">2</span>)</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a>  lambda.boot <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>  lambda.se <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>  lambda.bias <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a>      xx <span class="ot">=</span> <span class="fu">sample</span>(x, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a>      lambda.boot[i] <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xx)</span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a>    }</span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>    lambda.se[j] <span class="ot">=</span> <span class="fu">sd</span>(lambda.boot)</span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a>    lambda.bias[j] <span class="ot">=</span> <span class="fu">mean</span>(lambda.boot) <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a>  }</span>
<span id="cb39-19"><a href="#cb39-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;n =&quot;</span>,n,<span class="st">&quot;, bootstrap bias =&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(lambda.bias), <span class="dv">3</span>),<span class="st">&quot;, bootstrap se =&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(lambda.se), <span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb39-20"><a href="#cb39-20" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## n = 5 , bootstrap bias = -1.102 , bootstrap se = 1.38 
## n = 10 , bootstrap bias = 0.346 , bootstrap se = 0.583 
## n = 20 , bootstrap bias = 0.1 , bootstrap se = 0.505</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># theoretical</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> N){</span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>  bias <span class="ot">=</span> <span class="fu">round</span>(<span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>), <span class="dv">3</span>)</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>  se <span class="ot">=</span> <span class="fu">round</span>(<span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>), <span class="dv">3</span>)</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;n =&quot;</span>,n,<span class="st">&quot;, bias =&quot;</span>,bias,<span class="st">&quot;, se =&quot;</span>,se,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## n = 5 , bias = 0.5 , se = 1.443 
## n = 10 , bias = 0.222 , se = 0.786 
## n = 20 , bias = 0.105 , se = 0.496</code></pre>
<p>可以看到随着n增加，bootstrap结果接近theoretical结果。</p>
</div>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2(law data in bootstrap).</p>
<div id="answer-17" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(law)</span>
<span id="cb43-7"><a href="#cb43-7" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb43-8"><a href="#cb43-8" tabindex="-1"></a>t.star <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb43-9"><a href="#cb43-9" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb43-10"><a href="#cb43-10" tabindex="-1"></a>cor.hat <span class="ot">&lt;-</span> <span class="fu">cor</span>(law<span class="sc">$</span>LSAT,law<span class="sc">$</span>GPA)</span>
<span id="cb43-11"><a href="#cb43-11" tabindex="-1"></a></span>
<span id="cb43-12"><a href="#cb43-12" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb43-13"><a href="#cb43-13" tabindex="-1"></a>  <span class="co">#randomly select the indices</span></span>
<span id="cb43-14"><a href="#cb43-14" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-15"><a href="#cb43-15" tabindex="-1"></a>  LSAT <span class="ot">&lt;-</span> law<span class="sc">$</span>LSAT[i] <span class="co">#i is a vector of indices</span></span>
<span id="cb43-16"><a href="#cb43-16" tabindex="-1"></a>  GPA <span class="ot">&lt;-</span> law<span class="sc">$</span>GPA[i]</span>
<span id="cb43-17"><a href="#cb43-17" tabindex="-1"></a>  R[b] <span class="ot">&lt;-</span> <span class="fu">cor</span>(LSAT, GPA)</span>
<span id="cb43-18"><a href="#cb43-18" tabindex="-1"></a>  R.b.se <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb43-19"><a href="#cb43-19" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb43-20"><a href="#cb43-20" tabindex="-1"></a>    ii <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-21"><a href="#cb43-21" tabindex="-1"></a>    <span class="co">#LSAT.b = LSAT[ii]</span></span>
<span id="cb43-22"><a href="#cb43-22" tabindex="-1"></a>    <span class="co">#GPA.b = GPA[ii]</span></span>
<span id="cb43-23"><a href="#cb43-23" tabindex="-1"></a>    R.b.se[j] <span class="ot">=</span> <span class="fu">cor</span>(law<span class="sc">$</span>LSAT[ii], law<span class="sc">$</span>GPA[ii])</span>
<span id="cb43-24"><a href="#cb43-24" tabindex="-1"></a>  }</span>
<span id="cb43-25"><a href="#cb43-25" tabindex="-1"></a>  t.star[b] <span class="ot">=</span> (R[b] <span class="sc">-</span> cor.hat)<span class="sc">/</span><span class="fu">sd</span>(R.b.se)</span>
<span id="cb43-26"><a href="#cb43-26" tabindex="-1"></a>}</span>
<span id="cb43-27"><a href="#cb43-27" tabindex="-1"></a></span>
<span id="cb43-28"><a href="#cb43-28" tabindex="-1"></a><span class="co"># alpha=0.05</span></span>
<span id="cb43-29"><a href="#cb43-29" tabindex="-1"></a>t1 <span class="ot">=</span> <span class="fu">quantile</span>(t.star,<span class="fl">0.025</span>)</span>
<span id="cb43-30"><a href="#cb43-30" tabindex="-1"></a>t2 <span class="ot">=</span> <span class="fu">quantile</span>(t.star,<span class="fl">0.975</span>)</span>
<span id="cb43-31"><a href="#cb43-31" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bootstrap t CI :&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;[&quot;</span>,cor.hat<span class="sc">-</span>t2<span class="sc">*</span><span class="fu">sd</span>(t.star),<span class="st">&quot;,&quot;</span>,cor.hat<span class="sc">-</span>t1<span class="sc">*</span><span class="fu">sd</span>(t.star),<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## bootstrap t CI : 
##  [ -0.6822944 , 3.441101 ]</code></pre>
</div>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>Compare the mean bootstrap bias and bootstrap standard error with
theoretical ones. Comment on the results.</p>
<div id="answer-18" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>N <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> N){</span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">rexp</span>(n,<span class="dv">2</span>)</span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a>  lambda.boot <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a>  lambda.se <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a>  lambda.bias <span class="ot">=</span> <span class="fu">numeric</span>(B)</span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>      xx <span class="ot">=</span> <span class="fu">sample</span>(x, n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-14"><a href="#cb45-14" tabindex="-1"></a>      lambda.boot[i] <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(xx)</span>
<span id="cb45-15"><a href="#cb45-15" tabindex="-1"></a>    }</span>
<span id="cb45-16"><a href="#cb45-16" tabindex="-1"></a>    lambda.se[j] <span class="ot">=</span> <span class="fu">sd</span>(lambda.boot)</span>
<span id="cb45-17"><a href="#cb45-17" tabindex="-1"></a>    lambda.bias[j] <span class="ot">=</span> <span class="fu">mean</span>(lambda.boot) <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb45-18"><a href="#cb45-18" tabindex="-1"></a>  }</span>
<span id="cb45-19"><a href="#cb45-19" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;n =&quot;</span>,n,<span class="st">&quot;, bootstrap bias =&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(lambda.bias), <span class="dv">3</span>),<span class="st">&quot;, bootstrap se =&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(lambda.se), <span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb45-20"><a href="#cb45-20" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## n = 5 , bootstrap bias = -1.102 , bootstrap se = 1.38 
## n = 10 , bootstrap bias = 0.346 , bootstrap se = 0.583 
## n = 20 , bootstrap bias = 0.1 , bootstrap se = 0.505</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="co"># theoretical</span></span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> N){</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a>  bias <span class="ot">=</span> <span class="fu">round</span>(<span class="dv">2</span><span class="sc">/</span>(n<span class="dv">-1</span>), <span class="dv">3</span>)</span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>  se <span class="ot">=</span> <span class="fu">round</span>(<span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>), <span class="dv">3</span>)</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">c</span>(<span class="st">&quot;n =&quot;</span>,n,<span class="st">&quot;, bias =&quot;</span>,bias,<span class="st">&quot;, se =&quot;</span>,se,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb47-6"><a href="#cb47-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## n = 5 , bias = 0.5 , se = 1.443 
## n = 10 , bias = 0.222 , se = 0.786 
## n = 20 , bias = 0.105 , se = 0.496</code></pre>
<p>可以看到随着n增加，bootstrap结果接近theoretical结果。</p>
</div>
</div>
<div id="question-3-3" class="section level2">
<h2>Question 3</h2>
<p>Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2(law data in bootstrap).</p>
<div id="answer-19" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(law)</span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>t.star <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>cor.hat <span class="ot">&lt;-</span> <span class="fu">cor</span>(law<span class="sc">$</span>LSAT,law<span class="sc">$</span>GPA)</span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>  <span class="co">#randomly select the indices</span></span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>  LSAT <span class="ot">&lt;-</span> law<span class="sc">$</span>LSAT[i] <span class="co">#i is a vector of indices</span></span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a>  GPA <span class="ot">&lt;-</span> law<span class="sc">$</span>GPA[i]</span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>  R[b] <span class="ot">&lt;-</span> <span class="fu">cor</span>(LSAT, GPA)</span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>  R.b.se <span class="ot">=</span> <span class="fu">numeric</span>(m)</span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb49-20"><a href="#cb49-20" tabindex="-1"></a>    ii <span class="ot">=</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-21"><a href="#cb49-21" tabindex="-1"></a>    <span class="co">#LSAT.b = LSAT[ii]</span></span>
<span id="cb49-22"><a href="#cb49-22" tabindex="-1"></a>    <span class="co">#GPA.b = GPA[ii]</span></span>
<span id="cb49-23"><a href="#cb49-23" tabindex="-1"></a>    R.b.se[j] <span class="ot">=</span> <span class="fu">cor</span>(law<span class="sc">$</span>LSAT[ii], law<span class="sc">$</span>GPA[ii])</span>
<span id="cb49-24"><a href="#cb49-24" tabindex="-1"></a>  }</span>
<span id="cb49-25"><a href="#cb49-25" tabindex="-1"></a>  t.star[b] <span class="ot">=</span> (R[b] <span class="sc">-</span> cor.hat)<span class="sc">/</span><span class="fu">sd</span>(R.b.se)</span>
<span id="cb49-26"><a href="#cb49-26" tabindex="-1"></a>}</span>
<span id="cb49-27"><a href="#cb49-27" tabindex="-1"></a></span>
<span id="cb49-28"><a href="#cb49-28" tabindex="-1"></a><span class="co"># alpha=0.05</span></span>
<span id="cb49-29"><a href="#cb49-29" tabindex="-1"></a>t1 <span class="ot">=</span> <span class="fu">quantile</span>(t.star,<span class="fl">0.025</span>)</span>
<span id="cb49-30"><a href="#cb49-30" tabindex="-1"></a>t2 <span class="ot">=</span> <span class="fu">quantile</span>(t.star,<span class="fl">0.975</span>)</span>
<span id="cb49-31"><a href="#cb49-31" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bootstrap t CI :&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;[&quot;</span>,cor.hat<span class="sc">-</span>t2<span class="sc">*</span><span class="fu">sd</span>(t.star),<span class="st">&quot;,&quot;</span>,cor.hat<span class="sc">-</span>t1<span class="sc">*</span><span class="fu">sd</span>(t.star),<span class="st">&quot;]&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## bootstrap t CI : 
##  [ -0.6822944 , 3.441101 ]</code></pre>
</div>
</div>
</div>
<div id="homework-2023.10.23" class="section level1">
<h1>Homework-2023.10.23</h1>
<div id="question-1-7.5" class="section level2">
<h2>Question 1 (7.5)</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/λ\)</span>
by the standard normal, basic, percentile, and BCa methods. Compare the
intervals and explain why they may differ.</p>
<div id="answer-20" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>b.mean <span class="ot">&lt;-</span> <span class="cf">function</span>(x,i) <span class="fu">mean</span>(x[i])</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x, <span class="at">statistic=</span>b.mean, <span class="at">R =</span> <span class="dv">999</span>)</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a><span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 999 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = de, type = c(&quot;norm&quot;, &quot;basic&quot;, &quot;perc&quot;, &quot;bca&quot;))
## 
## Intervals : 
## Level      Normal              Basic         
## 95%   ( 35.5, 183.4 )   ( 23.6, 171.6 )  
## 
## Level     Percentile            BCa          
## 95%   ( 44.6, 192.6 )   ( 57.9, 241.3 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
<p>BCa intervals are “better” than other types of bootstrap intervals in
terms of coverage.</p>
</div>
</div>
<div id="question-2-7.8" class="section level2">
<h2>Question 2 (7.8)</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<div id="answer-21" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">88</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>Sigma.hat <span class="ot">=</span> <span class="fu">cor</span>(scor)</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>lambda.hat <span class="ot">=</span> <span class="fu">eigen</span>(Sigma.hat)<span class="sc">$</span>values</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>theta.hat <span class="ot">=</span> lambda.hat[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.hat)</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>theta.jack <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>  Sigma.jack <span class="ot">=</span> <span class="fu">cor</span>(scor[(<span class="dv">1</span><span class="sc">:</span>n)[<span class="sc">-</span>i],])</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>  lambda.jack <span class="ot">=</span> <span class="fu">eigen</span>(Sigma.jack)<span class="sc">$</span>values</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>  theta.jack[i] <span class="ot">=</span> lambda.jack[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(lambda.jack)</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>}</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.jack)<span class="sc">-</span>theta.hat)</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.jack<span class="sc">-</span>theta.hat)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a></span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original=</span>theta.hat,<span class="at">bias.jack=</span>bias.jack,</span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a><span class="at">se.jack=</span>se.jack),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##     0.636     0.000     0.045</code></pre>
</div>
</div>
<div id="question-3-7.11" class="section level2">
<h2>Question 3 (7.11)</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<div id="answer-22" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">combn</span>(n,<span class="dv">2</span>))</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(index)</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>vec.norm <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>index[k,]]</span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>index[k,]]</span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a>  yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[index[k,]]</span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a>  e1[k] <span class="ot">&lt;-</span> <span class="fu">vec.norm</span>(magnetic[index[k,]] <span class="sc">-</span> yhat1)</span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>  yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[index[k,]] <span class="sc">+</span></span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>  J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[index[k,]]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>  e2[k] <span class="ot">&lt;-</span> <span class="fu">vec.norm</span>(magnetic[index[k,]] <span class="sc">-</span> yhat2)</span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>  logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[index[k,]]</span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a>  yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a>  e3[k] <span class="ot">&lt;-</span> <span class="fu">vec.norm</span>(magnetic[index[k,]] <span class="sc">-</span> yhat3)</span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a>  logyhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(chemical[index[k,]])</span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a>  yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a>  e4[k] <span class="ot">&lt;-</span> <span class="fu">vec.norm</span>(magnetic[index[k,]] <span class="sc">-</span> yhat4)</span>
<span id="cb55-29"><a href="#cb55-29" tabindex="-1"></a>}</span>
<span id="cb55-30"><a href="#cb55-30" tabindex="-1"></a></span>
<span id="cb55-31"><a href="#cb55-31" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>), <span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<pre><code>## [1] 39.14455 35.74037 36.90983 40.93436</code></pre>
</div>
</div>
</div>
<div id="homework-2023.10.30" class="section level1">
<h1>Homework-2023.10.30</h1>
<div id="question-1-5" class="section level2">
<h2>Question 1</h2>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
<div id="answer-23" class="section level3">
<h3>Answer</h3>
<p>Denote <span class="math inline">\(x^*\sim q(x^*\mid x_i)\)</span>
and <span class="math inline">\(\alpha(x_i,x^*)=\min\{1,\frac{p(x^*)q(x_i|x^*)}{p(x_i)q(x^*|x_i)}\}\)</span>.</p>
<p>We will prove that the transition kernel of the Markov chain holds
the detailed balance condition, that is <span class="math display">\[
p(x_i)K(x_{i+1}\mid x_i)=p(x_{i+1})K(x_i\mid
x_{i+1}),\mathrm{~}\forall(x_i,x_{i+1}).
\]</span></p>
<p>The transition kernel is <span class="math display">\[
K(x_{i+1}\mid x_i)=q(x_{i+1}\mid
x_i)\alpha(x_i,x_{i+1})+I({x_i}=x_{i+1})r(x_i),
\]</span> where <span class="math inline">\(r(x_i)=P(\text{reject
}x^*)=1-\int\alpha(x_i,s)q(s\mid x_i)ds\)</span>.</p>
<p><strong>Case 1: <span class="math inline">\(x_i=x_{i+1}\)</span></strong></p>
<p>Then it is trivial that <span class="math display">\[
p(x_i)K(x_{i+1}\mid x_i)=p(x_{i+1})K(x_i\mid
x_{i+1}),\mathrm{~}\forall(x_i,x_{i+1}).
\]</span></p>
<p><strong>Case 2: <span class="math inline">\(x_i\ne
x_{i+1}\)</span></strong></p>
<p>We have <span class="math display">\[
\begin{align}
p(x_i)K(x_{i+1}\mid x_i)&amp;=p(x_i)q(x_{i+1}\mid
x_i)\alpha(x_i,x_{i+1})\\
&amp;=p(x_i)q(x_{i+1}\mid
x_i)\min\{1,\frac{p(x_{i+1})q(x_i|x_{i+1})}{p(x_i)q(x_{i+1}|x_i)}\}\\
&amp;=\min\{p(x_i)q(x_{i+1}\mid x_i),p(x_{i+1})q(x_i|x_{i+1})\}.
\end{align}
\]</span></p>
<p>We will get <span class="math inline">\(p(x_{i+1})K(x_i\mid
x_{i+1})=\min\{p(x_i)q(x_{i+1}\mid
x_i),p(x_{i+1})q(x_i|x_{i+1})\}\)</span> if we do the same to <span class="math inline">\(p(x_{i+1})K(x_i\mid x_{i+1})\)</span>, thus the
proof is concluded.</p>
</div>
</div>
<div id="question-2-ex-8.1" class="section level2">
<h2>Question 2 (Ex 8.1)</h2>
<p>Implement the two-sample Cramer-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<div id="answer-24" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>cvm.test <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">length</span>(x)</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>  m <span class="ot">=</span> <span class="fu">length</span>(y)</span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a>  F_n <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)</span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>  G_m <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)</span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>  </span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>  s1 <span class="ot">=</span> <span class="fu">sum</span>((<span class="fu">F_n</span>(x)<span class="sc">-</span><span class="fu">G_m</span>(x))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>  s2 <span class="ot">=</span> <span class="fu">sum</span>((<span class="fu">F_n</span>(y)<span class="sc">-</span><span class="fu">G_m</span>(y))<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb57-9"><a href="#cb57-9" tabindex="-1"></a>  W <span class="ot">=</span> m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(s1<span class="sc">+</span>s2)</span>
<span id="cb57-10"><a href="#cb57-10" tabindex="-1"></a>  <span class="fu">return</span>(W)</span>
<span id="cb57-11"><a href="#cb57-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">library</span>(twosamples)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="fu">attach</span>(chickwts)</span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a><span class="fu">detach</span>(chickwts)</span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>W <span class="ot">=</span> <span class="fu">cvm.test</span>(x,y)</span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a><span class="fu">print</span>(W)</span></code></pre></div>
<pre><code>## [1] 0.1515216</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">cvm_test</span>(x,y))</span></code></pre></div>
<pre><code>## Test Stat   P-Value 
## 0.6096939 0.4120000</code></pre>
</div>
</div>
<div id="question-3-ex-8.3" class="section level2">
<h2>Question 3 (Ex 8.3)</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
<div id="answer-25" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>count5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>  X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>  outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> <span class="dv">5</span>))</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a>}</span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a><span class="co"># assume length(x)&lt;=length(y)</span></span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>count5test.ue <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">R=</span><span class="dv">999</span>) {</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>  n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>  n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb62-13"><a href="#cb62-13" tabindex="-1"></a>  reps <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb62-14"><a href="#cb62-14" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R){</span>
<span id="cb62-15"><a href="#cb62-15" tabindex="-1"></a>    k <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n2, <span class="at">size =</span> n1, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-16"><a href="#cb62-16" tabindex="-1"></a>    y1 <span class="ot">&lt;-</span> y[k]</span>
<span id="cb62-17"><a href="#cb62-17" tabindex="-1"></a>    reps[i] <span class="ot">=</span> <span class="fu">count5test</span>(x,y1)</span>
<span id="cb62-18"><a href="#cb62-18" tabindex="-1"></a>  }</span>
<span id="cb62-19"><a href="#cb62-19" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">mean</span>(reps) <span class="sc">&gt;</span> <span class="fl">0.5</span></span>
<span id="cb62-20"><a href="#cb62-20" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="co"># example 6.15</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>alphahat <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x) <span class="co">#centered by sample mean</span></span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>  y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>  <span class="fu">count5test.ue</span>(x, y)</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>}))</span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a><span class="fu">print</span>(alphahat)</span></code></pre></div>
<pre><code>## [1] 0.033</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>power <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">replicate</span>(m, <span class="at">expr=</span>{</span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma1)</span>
<span id="cb65-5"><a href="#cb65-5" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma2)</span>
<span id="cb65-6"><a href="#cb65-6" tabindex="-1"></a>  <span class="fu">count5test.ue</span>(x, y)</span>
<span id="cb65-7"><a href="#cb65-7" tabindex="-1"></a>}))</span>
<span id="cb65-8"><a href="#cb65-8" tabindex="-1"></a><span class="fu">print</span>(power)</span></code></pre></div>
<pre><code>## [1] 0.239</code></pre>
</div>
</div>
</div>
<div id="homework-2023.11.06" class="section level1">
<h1>Homework-2023.11.06</h1>
<div id="question-1-6" class="section level2">
<h2>Question 1</h2>
<p>Consider a model <span class="math display">\[
P(Y=1\mid
X_1,X_2,X_3)=\frac{\exp(a+b_1X_1+b_2X_2+b_3X_3)}{1+\exp(a+b_1X_1+b_2X_2+b_3X_3)},
\]</span> where <span class="math inline">\(X_1 \sim P(1), X_2 \sim
Exp(1)\)</span> and <span class="math inline">\(X_3 \sim B(1,
0.5)\)</span>.</p>
<div id="section" class="section level3">
<h3>(1)</h3>
<p>Design a function that takes as input values <span class="math inline">\(N, b_1, b_2, b_3\)</span> and <span class="math inline">\(f_0\)</span>, and produces the output <span class="math inline">\(a\)</span>.</p>
</div>
<div id="answer-26" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>  x1 <span class="ot">=</span> <span class="fu">rpois</span>(N,<span class="dv">1</span>)</span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>  x2 <span class="ot">=</span> <span class="fu">rexp</span>(N)</span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>  x3 <span class="ot">=</span> <span class="fu">rbinom</span>(N,<span class="dv">1</span>,<span class="fl">0.5</span>)</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>  obs <span class="ot">=</span> b1<span class="sc">*</span>x1 <span class="sc">+</span> b2<span class="sc">*</span>x2 <span class="sc">+</span> b3<span class="sc">*</span>x3</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(x<span class="sc">+</span>obs))) <span class="sc">+</span> f0 <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>  </span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>  a <span class="ot">=</span> <span class="fu">uniroot</span>(g, <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>,<span class="dv">20</span>))<span class="sc">$</span>root</span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>  <span class="co">#print(g(20))</span></span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a>  <span class="co">#print(g(-20))</span></span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>  <span class="fu">return</span>(a)</span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="section-1" class="section level3">
<h3>(2)</h3>
<p>Call this function, input values are <span class="math inline">\(N =
10^6 , b_1 = 0, b_2 = 1, b_3 = −1, f_0 = 0.1, 0.01, 0.001,
0.0001\)</span>.</p>
</div>
<div id="answer-27" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>N <span class="ot">=</span> <span class="fl">1e6</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>b1 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>b2 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>b3 <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a>f0 <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>, <span class="fl">0.0001</span>) </span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>  a[i] <span class="ot">=</span> <span class="fu">f</span>(N,b1,b2,b3,f0[i])</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>}</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a><span class="fu">print</span>(a)</span></code></pre></div>
<pre><code>## [1]  -3.168830  -6.075608  -8.718858 -11.234627</code></pre>
</div>
<div id="section-2" class="section level3">
<h3>(3)</h3>
<p>Plot <span class="math inline">\(− \log f_0\)</span> vs <span class="math inline">\(a\)</span>.</p>
</div>
<div id="answer-28" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span><span class="fu">log</span>(f0),a)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-2-ex-9.4" class="section level2">
<h2>Question 2 (Ex 9.4)</h2>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<div id="answer-29" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>laplace <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x))</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>chain <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, n, x1){</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">numeric</span>(n)</span>
<span id="cb71-5"><a href="#cb71-5" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">=</span> x1</span>
<span id="cb71-6"><a href="#cb71-6" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb71-7"><a href="#cb71-7" tabindex="-1"></a>  k <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb71-8"><a href="#cb71-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb71-9"><a href="#cb71-9" tabindex="-1"></a>    xt <span class="ot">=</span> x[i<span class="dv">-1</span>]</span>
<span id="cb71-10"><a href="#cb71-10" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, xt, sigma)</span>
<span id="cb71-11"><a href="#cb71-11" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> <span class="fu">laplace</span>(y)<span class="sc">/</span><span class="fu">laplace</span>(xt)) x[i] <span class="ot">=</span> y</span>
<span id="cb71-12"><a href="#cb71-12" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb71-13"><a href="#cb71-13" tabindex="-1"></a>      x[i] <span class="ot">=</span> xt</span>
<span id="cb71-14"><a href="#cb71-14" tabindex="-1"></a>      k <span class="ot">=</span> k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb71-15"><a href="#cb71-15" tabindex="-1"></a>    }</span>
<span id="cb71-16"><a href="#cb71-16" tabindex="-1"></a>  }</span>
<span id="cb71-17"><a href="#cb71-17" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">k=</span>k))</span>
<span id="cb71-18"><a href="#cb71-18" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># simulation</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a>sigmas <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="fl">2.5</span>,<span class="dv">16</span>)</span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">2000</span></span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a></span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>theta0 <span class="ot">&lt;-</span> c</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>rw1 <span class="ot">=</span> <span class="fu">chain</span>(sigmas[<span class="dv">1</span>],n,<span class="dv">50</span>)</span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>rw2 <span class="ot">=</span> <span class="fu">chain</span>(sigmas[<span class="dv">2</span>],n,<span class="dv">50</span>)</span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>rw3 <span class="ot">=</span> <span class="fu">chain</span>(sigmas[<span class="dv">3</span>],n,<span class="dv">50</span>)</span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a>rw4 <span class="ot">=</span> <span class="fu">chain</span>(sigmas[<span class="dv">4</span>],n,<span class="dv">50</span>)</span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>kk <span class="ot">=</span> <span class="fu">c</span>(rw1<span class="sc">$</span>k,rw2<span class="sc">$</span>k,rw3<span class="sc">$</span>k,rw4<span class="sc">$</span>k)</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a>rw <span class="ot">=</span> <span class="fu">rbind</span>(rw1<span class="sc">$</span>x,rw2<span class="sc">$</span>x,rw3<span class="sc">$</span>x,rw4<span class="sc">$</span>x)</span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a><span class="fu">print</span>(kk<span class="sc">/</span>n)</span></code></pre></div>
<pre><code>## [1] 0.0150 0.1705 0.5405 0.9060</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>){</span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>  <span class="fu">plot</span>(rw[i,], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigmas[i],<span class="dv">3</span>))), <span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">1</span>,n), <span class="at">ylim=</span><span class="fu">range</span>(rw[i,]))</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-3-ex-9.7" class="section level2">
<h2>Question 3 (Ex 9.7)</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain <span class="math inline">\((X_t, Y_t)\)</span> with zero means, unit standard
deviations, and correlation 0.9. Plot the generated sample after
discarding a suitable burn-in sample. Fit a simple linear regression
model <span class="math inline">\(Y = \beta_0 + \beta_1X\)</span> to the
sample and check the residuals of the model for normality and constant
variance.</p>
<div id="answer-30" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5000</span></span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>burn <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>da <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,n,<span class="dv">2</span>)</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">0.9</span></span>
<span id="cb75-6"><a href="#cb75-6" tabindex="-1"></a>mu1 <span class="ot">=</span> mu2 <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb75-7"><a href="#cb75-7" tabindex="-1"></a>sigma1 <span class="ot">=</span> sigma2 <span class="ot">=</span><span class="dv">1</span></span>
<span id="cb75-8"><a href="#cb75-8" tabindex="-1"></a>s1 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb75-9"><a href="#cb75-9" tabindex="-1"></a>s2 <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb75-10"><a href="#cb75-10" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" tabindex="-1"></a>da[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">c</span>(mu1,mu2)</span>
<span id="cb75-12"><a href="#cb75-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n){</span>
<span id="cb75-13"><a href="#cb75-13" tabindex="-1"></a>  y <span class="ot">=</span> da[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb75-14"><a href="#cb75-14" tabindex="-1"></a>  m1 <span class="ot">=</span> mu1 <span class="sc">+</span> rho<span class="sc">*</span>(y<span class="sc">-</span>mu2)<span class="sc">*</span>sigma1<span class="sc">/</span>sigma2</span>
<span id="cb75-15"><a href="#cb75-15" tabindex="-1"></a>  da[i,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m1,s1)</span>
<span id="cb75-16"><a href="#cb75-16" tabindex="-1"></a>  x <span class="ot">=</span> da[i,<span class="dv">1</span>]</span>
<span id="cb75-17"><a href="#cb75-17" tabindex="-1"></a>  m2 <span class="ot">=</span> mu2 <span class="sc">+</span> rho<span class="sc">*</span>(x<span class="sc">-</span>mu1)<span class="sc">*</span>sigma2<span class="sc">/</span>sigma1</span>
<span id="cb75-18"><a href="#cb75-18" tabindex="-1"></a>  da[i,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,m2,s2)</span>
<span id="cb75-19"><a href="#cb75-19" tabindex="-1"></a>}</span>
<span id="cb75-20"><a href="#cb75-20" tabindex="-1"></a></span>
<span id="cb75-21"><a href="#cb75-21" tabindex="-1"></a><span class="fu">plot</span>(da[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="dv">1</span>],da[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,<span class="dv">2</span>],<span class="at">xlab =</span> <span class="fu">bquote</span>(X_t),<span class="at">ylab =</span> <span class="fu">bquote</span>(Y_t),<span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>da.burn <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(da[(burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n,])</span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="fu">lm</span>(da.burn[,<span class="dv">1</span>]<span class="sc">~</span>da.burn[,<span class="dv">2</span>])</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = da.burn[, 1] ~ da.burn[, 2])
## 
## Coefficients:
##  (Intercept)  da.burn[, 2]  
##      -0.0122        0.9064</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="fu">colnames</span>(da.burn) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;X&quot;</span>,<span class="st">&quot;Y&quot;</span>)</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a><span class="fu">colMeans</span>(da.burn)</span></code></pre></div>
<pre><code>##          X          Y 
## 0.01047471 0.02501647</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="fu">cov</span>(da.burn)</span></code></pre></div>
<pre><code>##           X         Y
## X 1.0356444 0.9229262
## Y 0.9229262 1.0181768</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="fu">cor</span>(da.burn)</span></code></pre></div>
<pre><code>##           X         Y
## X 1.0000000 0.8987731
## Y 0.8987731 1.0000000</code></pre>
</div>
</div>
<div id="question-3-ex-9.10" class="section level2">
<h2>Question 3 (Ex 9.10)</h2>
<p>Refer to Example 9.1. Use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to <span class="math inline">\(\hat R &lt; 1.2\)</span>. (See Exercise 9.9.) Also
use the <code>coda</code> [212] package to check for convergence of the
chain by the Gelman-Rubin method. Hints: See the help topics for the
<code>coda</code> functions <code>gelman.diag</code>,
<code>gelman.plot</code>, <code>as.mcmc</code>, and
<code>mcmc.list</code>.</p>
<div id="answer-31" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,sigma){</span>
<span id="cb84-4"><a href="#cb84-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span> (<span class="dv">0</span>)</span>
<span id="cb84-5"><a href="#cb84-5" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb84-6"><a href="#cb84-6" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb84-7"><a href="#cb84-7" tabindex="-1"></a>}</span>
<span id="cb84-8"><a href="#cb84-8" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" tabindex="-1"></a>lap.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(m, sigma){</span>
<span id="cb84-10"><a href="#cb84-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb84-11"><a href="#cb84-11" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb84-12"><a href="#cb84-12" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb84-13"><a href="#cb84-13" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb84-14"><a href="#cb84-14" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb84-15"><a href="#cb84-15" tabindex="-1"></a>    xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb84-16"><a href="#cb84-16" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb84-17"><a href="#cb84-17" tabindex="-1"></a>    num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb84-18"><a href="#cb84-18" tabindex="-1"></a>    den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb84-19"><a href="#cb84-19" tabindex="-1"></a>    <span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb84-20"><a href="#cb84-20" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb84-21"><a href="#cb84-21" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb84-22"><a href="#cb84-22" tabindex="-1"></a>    }</span>
<span id="cb84-23"><a href="#cb84-23" tabindex="-1"></a>  }</span>
<span id="cb84-24"><a href="#cb84-24" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb84-25"><a href="#cb84-25" tabindex="-1"></a>}</span>
<span id="cb84-26"><a href="#cb84-26" tabindex="-1"></a></span>
<span id="cb84-27"><a href="#cb84-27" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi){</span>
<span id="cb84-28"><a href="#cb84-28" tabindex="-1"></a>  psi <span class="ot">=</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb84-29"><a href="#cb84-29" tabindex="-1"></a>  n <span class="ot">=</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb84-30"><a href="#cb84-30" tabindex="-1"></a>  k <span class="ot">=</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb84-31"><a href="#cb84-31" tabindex="-1"></a>  psi.means <span class="ot">=</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb84-32"><a href="#cb84-32" tabindex="-1"></a>  B <span class="ot">=</span> n<span class="sc">*</span><span class="fu">var</span>(psi.means)</span>
<span id="cb84-33"><a href="#cb84-33" tabindex="-1"></a>  psi.w <span class="ot">=</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)</span>
<span id="cb84-34"><a href="#cb84-34" tabindex="-1"></a>  W <span class="ot">=</span> <span class="fu">mean</span>(psi.w)</span>
<span id="cb84-35"><a href="#cb84-35" tabindex="-1"></a>  v.hat <span class="ot">=</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> B<span class="sc">/</span>(n<span class="sc">*</span>k)</span>
<span id="cb84-36"><a href="#cb84-36" tabindex="-1"></a>  r.hat <span class="ot">=</span> v.hat<span class="sc">/</span>W</span>
<span id="cb84-37"><a href="#cb84-37" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb84-38"><a href="#cb84-38" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>k <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>burn <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> k, <span class="at">ncol =</span> m)</span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a>  X[i,] <span class="ot">=</span> <span class="fu">lap.chain</span>(m,sigma)</span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a>}</span>
<span id="cb85-10"><a href="#cb85-10" tabindex="-1"></a></span>
<span id="cb85-11"><a href="#cb85-11" tabindex="-1"></a>psi <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb85-12"><a href="#cb85-12" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb85-13"><a href="#cb85-13" tabindex="-1"></a>  psi[i,] <span class="ot">=</span> psi[i,]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb85-14"><a href="#cb85-14" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.012734</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>  <span class="fu">plot</span>(psi[i, (burn<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span>i, <span class="at">ylab=</span><span class="fu">bquote</span>(psi))</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a>la.mc <span class="ot">=</span> <span class="fu">mcmc.list</span>(<span class="fu">as.mcmc</span>(X[<span class="dv">1</span>,]),<span class="fu">as.mcmc</span>(X[<span class="dv">2</span>,]),<span class="fu">as.mcmc</span>(X[<span class="dv">3</span>,]),<span class="fu">as.mcmc</span>(X[<span class="dv">4</span>,]))</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a><span class="fu">gelman.diag</span>(la.mc)</span></code></pre></div>
<pre><code>## Potential scale reduction factors:
## 
##      Point est. Upper C.I.
## [1,]          1          1</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="fu">gelman.plot</span>(la.mc)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
</div>
<div id="homework-2023.11.13" class="section level1">
<h1>Homework-2023.11.13</h1>
<div id="question-1-7" class="section level2">
<h2>Question 1</h2>
<p>设<span class="math inline">\(X_1,\cdots,X_n \sim
Exp(\lambda)\)</span>独立同分布，只知道<span class="math inline">\(X_i\)</span>存在某个区间<span class="math inline">\((u_i,v_i)\)</span>，其中<span class="math inline">\(u_i&lt;v_i\)</span>是两个非随机的常数。这种数据称为区间删失数据。</p>
<ol style="list-style-type: decimal">
<li><p>试分别直接极大化观测数据的似然函数与采用EM算法求解<span class="math inline">\(\lambda\)</span>的MLE，证明EM算法收敛于观测数据的MLE，且收敛有线性速度。</p></li>
<li><p>设<span class="math inline">\((u_i,v_i)\
i=1,\cdots,10\)</span>的观测值为 <span class="math inline">\((11,12),(8,9),(27,28),(13,14),(16,17),(0,1),(23,24),(10,11),(24,25),(2,3)\)</span>.</p></li>
</ol>
<p>分别编程实现上述两种算法得到<span class="math inline">\(\lambda\)</span>的MLE的数值解。</p>
<p><strong>Hint:</strong> <span class="math inline">\(L(\lambda)=\Pi_{i=1}^n \mathbb{P}_\lambda(u_i \le
X_i \le v_i)\)</span></p>
<div id="answer-32" class="section level3">
<h3>Answer</h3>
<p><strong>Proof of convergence</strong></p>
<p>For any <span class="math inline">\(\mathbf {Z}\)</span> with
non-zero probability <span class="math inline">\({\displaystyle
p(\mathbf {Z} \mid \mathbf {X} ,{\boldsymbol {\theta }})}\)</span>, we
can write</p>
<p><span class="math display">\[
{\displaystyle \log p(\mathbf {X} \mid {\boldsymbol {\theta }})=\log
p(\mathbf {X} ,\mathbf {Z} \mid {\boldsymbol {\theta }})-\log p(\mathbf
{Z} \mid \mathbf {X} ,{\boldsymbol {\theta }}).}
\]</span> We take the expectation over possible values of the unknown
data <span class="math inline">\(\mathbf {Z}\)</span> under the current
parameter estimate <span class="math inline">\(\theta^{(t)}\)</span> by
multiplying both sides by <span class="math inline">\({\displaystyle
p(\mathbf {Z} \mid \mathbf {X} ,{\boldsymbol {\theta }}^{(t)})}\)</span>
and summing (or integrating) over <span class="math inline">\(\mathbf
{Z}\)</span> . The left-hand side is the expectation of a constant, so
we get: <span class="math display">\[
{\displaystyle {\begin{aligned}\log p(\mathbf {X} \mid {\boldsymbol
{\theta }})&amp;=\sum _{\mathbf {Z} }p(\mathbf {Z} \mid \mathbf {X}
,{\boldsymbol {\theta }}^{(t)})\log p(\mathbf {X} ,\mathbf {Z} \mid
{\boldsymbol {\theta }})-\sum _{\mathbf {Z} }p(\mathbf {Z} \mid \mathbf
{X} ,{\boldsymbol {\theta }}^{(t)})\log p(\mathbf {Z} \mid \mathbf {X}
,{\boldsymbol {\theta }})\\&amp;=Q({\boldsymbol {\theta }}\mid
{\boldsymbol {\theta }}^{(t)})+H({\boldsymbol {\theta }}\mid
{\boldsymbol {\theta }}^{(t)}),\end{aligned}}}
\]</span> Thus <span class="math inline">\({\displaystyle \log p(\mathbf
{X} \mid {\boldsymbol {\theta }}^{(t)})=Q({\boldsymbol {\theta
}}^{(t)}\mid {\boldsymbol {\theta }}^{(t)})+H({\boldsymbol {\theta
}}^{(t)}\mid {\boldsymbol {\theta }}^{(t)}),}\)</span>, and subtracting
this last equation from the previous equation gives</p>
<p><span class="math display">\[
{\displaystyle \log p(\mathbf {X} \mid {\boldsymbol {\theta }})-\log
p(\mathbf {X} \mid {\boldsymbol {\theta }}^{(t)})=Q({\boldsymbol {\theta
}}\mid {\boldsymbol {\theta }}^{(t)})-Q({\boldsymbol {\theta
}}^{(t)}\mid {\boldsymbol {\theta }}^{(t)})+H({\boldsymbol {\theta
}}\mid {\boldsymbol {\theta }}^{(t)})-H({\boldsymbol {\theta
}}^{(t)}\mid {\boldsymbol {\theta }}^{(t)}).}
\]</span></p>
<p>However, Gibbs’ inequality tells us that <span class="math inline">\({\displaystyle H({\boldsymbol {\theta }}\mid
{\boldsymbol {\theta }}^{(t)})\geq H({\boldsymbol {\theta }}^{(t)}\mid
{\boldsymbol {\theta }}^{(t)})}\)</span>, so we can conclude that <span class="math display">\[
{\displaystyle \log p(\mathbf {X} \mid {\boldsymbol {\theta }})-\log
p(\mathbf {X} \mid {\boldsymbol {\theta }}^{(t)})\geq Q({\boldsymbol
{\theta }}\mid {\boldsymbol {\theta }}^{(t)})-Q({\boldsymbol {\theta
}}^{(t)}\mid {\boldsymbol {\theta }}^{(t)}).}
\]</span></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>u <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>v <span class="ot">=</span> u <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a><span class="co"># 似然函数</span></span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda){</span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>  ll <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb91-8"><a href="#cb91-8" tabindex="-1"></a>    t <span class="ot">=</span> <span class="fu">max</span>(<span class="fl">1e-5</span>,<span class="fu">pexp</span>(v[i],<span class="at">rate =</span> lambda)<span class="sc">-</span><span class="fu">pexp</span>(u[i],<span class="at">rate =</span> lambda))</span>
<span id="cb91-9"><a href="#cb91-9" tabindex="-1"></a>    ll <span class="ot">=</span> ll <span class="sc">+</span> <span class="fu">log</span>(t)</span>
<span id="cb91-10"><a href="#cb91-10" tabindex="-1"></a>  }</span>
<span id="cb91-11"><a href="#cb91-11" tabindex="-1"></a>  <span class="fu">return</span>(ll)</span>
<span id="cb91-12"><a href="#cb91-12" tabindex="-1"></a>}</span>
<span id="cb91-13"><a href="#cb91-13" tabindex="-1"></a><span class="co"># 极大似然</span></span>
<span id="cb91-14"><a href="#cb91-14" tabindex="-1"></a><span class="fu">optimize</span>(L,<span class="at">lower=</span><span class="fl">1e-3</span>,<span class="at">upper=</span><span class="dv">5</span>,<span class="at">maximum=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## $maximum
## [1] 0.07197406
## 
## $objective
## [1] -36.31673</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="co"># EM</span></span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>Ex <span class="ot">&lt;-</span> <span class="cf">function</span>(u,v,lambda){</span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>  a <span class="ot">=</span> u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v)<span class="sc">+</span>(<span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>v))<span class="sc">/</span>lambda</span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>  b <span class="ot">=</span> <span class="fu">pexp</span>(v,lambda)<span class="sc">-</span><span class="fu">pexp</span>(u,lambda)</span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a>  <span class="fu">return</span>(a<span class="sc">/</span>b)</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a>}</span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a>EM <span class="ot">&lt;-</span> <span class="cf">function</span>(u,v,<span class="at">max.it=</span><span class="fl">1e4</span>,<span class="at">eps=</span><span class="fl">1e-5</span>){</span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a>  i <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a>  lambda1 <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb93-10"><a href="#cb93-10" tabindex="-1"></a>  lambda2 <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb93-11"><a href="#cb93-11" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb93-12"><a href="#cb93-12" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">abs</span>(lambda1<span class="sc">-</span>lambda2) <span class="sc">&gt;=</span> eps) {</span>
<span id="cb93-13"><a href="#cb93-13" tabindex="-1"></a>    lambda1 <span class="ot">=</span> lambda2</span>
<span id="cb93-14"><a href="#cb93-14" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb93-15"><a href="#cb93-15" tabindex="-1"></a>      x[i] <span class="ot">=</span> <span class="fu">Ex</span>(u[i],v[i],lambda1)</span>
<span id="cb93-16"><a href="#cb93-16" tabindex="-1"></a>    }</span>
<span id="cb93-17"><a href="#cb93-17" tabindex="-1"></a>    lambda2 <span class="ot">=</span> <span class="dv">10</span><span class="sc">/</span><span class="fu">sum</span>(x)</span>
<span id="cb93-18"><a href="#cb93-18" tabindex="-1"></a>  }</span>
<span id="cb93-19"><a href="#cb93-19" tabindex="-1"></a>  </span>
<span id="cb93-20"><a href="#cb93-20" tabindex="-1"></a>  <span class="fu">return</span>(lambda2)</span>
<span id="cb93-21"><a href="#cb93-21" tabindex="-1"></a>}</span>
<span id="cb93-22"><a href="#cb93-22" tabindex="-1"></a></span>
<span id="cb93-23"><a href="#cb93-23" tabindex="-1"></a><span class="fu">EM</span>(u,v)</span></code></pre></div>
<pre><code>## [1] 0.0719735</code></pre>
</div>
</div>
<div id="question-2-11.8" class="section level2">
<h2>Question 2 (11.8)</h2>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoff matrix, or a
positive constant is multiplied times every entry of the payoff matrix.
However, the simplex algorithm may terminate at a different basic
feasible point (also optimal). Compute <code>B &lt;- A + 2</code>, find
the Answer of game B, and verify that it is one of the extreme points
(11.12)–(11.15) of the original game A. Also find the value of game A
and game B.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>  <span class="co">#solve the two player zero-sum game by simplex method</span></span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>  <span class="co">#optimize for player 1, then player 2</span></span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>  <span class="co">#maximize v subject to ...</span></span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>  <span class="co">#let x strategies 1:m, and put v as extra variable</span></span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>  <span class="co">#A1, the &lt;= constraints</span></span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>  min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co">#so that v &gt;= 0</span></span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a>  max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb95-11"><a href="#cb95-11" tabindex="-1"></a>  A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb95-12"><a href="#cb95-12" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb95-13"><a href="#cb95-13" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb95-14"><a href="#cb95-14" tabindex="-1"></a>  it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb95-15"><a href="#cb95-15" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb95-16"><a href="#cb95-16" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) <span class="co">#constraints &lt;=</span></span>
<span id="cb95-17"><a href="#cb95-17" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb95-18"><a href="#cb95-18" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) <span class="co">#constraints sum(x)=1</span></span>
<span id="cb95-19"><a href="#cb95-19" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb95-20"><a href="#cb95-20" tabindex="-1"></a>  sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3, <span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb95-21"><a href="#cb95-21" tabindex="-1"></a>  <span class="co">#the ’Answer’ is [x1,x2,...,xm | value of game]</span></span>
<span id="cb95-22"><a href="#cb95-22" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb95-23"><a href="#cb95-23" tabindex="-1"></a>  <span class="co">#minimize v subject to ...</span></span>
<span id="cb95-24"><a href="#cb95-24" tabindex="-1"></a>  <span class="co">#let y strategies 1:n, with v as extra variable</span></span>
<span id="cb95-25"><a href="#cb95-25" tabindex="-1"></a>  a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb95-26"><a href="#cb95-26" tabindex="-1"></a>  A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m)) <span class="co">#constraints &lt;=</span></span>
<span id="cb95-27"><a href="#cb95-27" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb95-28"><a href="#cb95-28" tabindex="-1"></a>  A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>))) <span class="co">#constraints sum(y)=1</span></span>
<span id="cb95-29"><a href="#cb95-29" tabindex="-1"></a>  b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb95-30"><a href="#cb95-30" tabindex="-1"></a>  sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3, <span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb95-31"><a href="#cb95-31" tabindex="-1"></a>  soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,</span>
<span id="cb95-32"><a href="#cb95-32" tabindex="-1"></a>    <span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb95-33"><a href="#cb95-33" tabindex="-1"></a>    <span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb95-34"><a href="#cb95-34" tabindex="-1"></a>    <span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb95-35"><a href="#cb95-35" tabindex="-1"></a>  soln</span>
<span id="cb95-36"><a href="#cb95-36" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>  <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>  <span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>  <span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>  <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>  <span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a>  <span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb96-8"><a href="#cb96-8" tabindex="-1"></a>  <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb96-9"><a href="#cb96-9" tabindex="-1"></a>  <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb96-10"><a href="#cb96-10" tabindex="-1"></a></span>
<span id="cb96-11"><a href="#cb96-11" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#needed for simplex function</span></span>
<span id="cb96-12"><a href="#cb96-12" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">solve.game</span>(A <span class="sc">+</span> <span class="dv">2</span>)</span>
<span id="cb96-13"><a href="#cb96-13" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cbind</span>(s<span class="sc">$</span>x, s<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>value.A <span class="ot">=</span> <span class="fu">t</span>(s<span class="sc">$</span>x)<span class="sc">%*%</span>(A)<span class="sc">%*%</span>(s<span class="sc">$</span>y)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>value.B <span class="ot">=</span> <span class="fu">t</span>(s<span class="sc">$</span>x)<span class="sc">%*%</span>(A<span class="sc">+</span><span class="dv">2</span>)<span class="sc">%*%</span>(s<span class="sc">$</span>y)</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">c</span>(value.A,value.B),<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1] 0 2</code></pre>
</div>
</div>
<div id="homework-2023.11.20" class="section level1">
<h1>Homework-2023.11.20</h1>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<div id="question-1-8" class="section level2">
<h2>Question 1</h2>
<p>Why do you need to use <code>unlist()</code> to convert a list to an
atomic vector? Why doesn’t <code>as.vector()</code> work?</p>
<div id="answer-33" class="section level3">
<h3>Answer</h3>
<p>If mode = “any”, <code>is.vector</code> may return <code>TRUE</code>
for the atomic modes, <code>list</code> and <code>expression</code>.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">list</span>(<span class="at">a=</span><span class="dv">1</span>, <span class="at">b=</span><span class="dv">2</span>)</span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a><span class="fu">print</span>(x)</span></code></pre></div>
<pre><code>## $a
## [1] 1
## 
## $b
## [1] 2</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">unlist</span>(x)</span></code></pre></div>
<pre><code>## a b 
## 1 2</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="fu">as.vector</span>(x)</span></code></pre></div>
<pre><code>## $a
## [1] 1
## 
## $b
## [1] 2</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">is.vector</span>(x)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="question-2-4" class="section level2">
<h2>Question 2</h2>
<p>What does <code>dim()</code> return when applied to a vector?</p>
<div id="answer-34" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="fu">dim</span>(<span class="fu">unlist</span>(x))</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="fu">dim</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)</span></code></pre></div>
<pre><code>## NULL</code></pre>
</div>
</div>
<div id="question-3-4" class="section level2">
<h2>Question 3</h2>
<p>If <code>is.matrix(x)</code> is <code>TRUE</code>, what will
<code>is.array(x)</code> return?</p>
<div id="answer-35" class="section level3">
<h3>Answer</h3>
<ul>
<li><p><code>is.matrix</code> returns <code>TRUE</code> if
<code>x</code> is a vector and has a “<code>dim</code>” attribute of
length 2 and <code>FALSE</code> otherwise. Note that a
<code>data.frame</code> is <strong>not</strong> a matrix by this
test.</p></li>
<li><p><code>is.array</code> returns <code>TRUE</code> or
<code>FALSE</code> depending on whether its argument is an array (i.e.,
has a <code>dim</code> attribute of positive length) or not.</p></li>
</ul>
<p>Thus <code>is.array(x)</code> will return <code>TRUE</code>.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a>A <span class="ot">=</span><span class="fu">diag</span>(<span class="dv">3</span>)</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a><span class="fu">is.matrix</span>(A)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="fu">is.array</span>(A)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>What does <code>as.matrix()</code> do when applied to a data frame
with columns of different types?</p>
<div id="answer-36" class="section level3">
<h3>Answer</h3>
<p>Otherwise, the usual coercion hierarchy (logical &lt; integer &lt;
double &lt; complex) will be used, e.g., all-logical data frames will be
coerced to a logical matrix, mixed logical-integer will give a integer
matrix, etc.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">list</span>(<span class="at">name =</span> <span class="st">&quot;Wang&quot;</span>, <span class="at">id =</span> <span class="dv">1</span>, <span class="at">isfemale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a>da <span class="ot">=</span> <span class="fu">data.frame</span>(y)</span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a><span class="fu">as.matrix</span>(da)</span></code></pre></div>
<pre><code>##      name   id  isfemale
## [1,] &quot;Wang&quot; &quot;1&quot; &quot;TRUE&quot;</code></pre>
</div>
</div>
<div id="question-5-1" class="section level2">
<h2>Question 5</h2>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
<div id="answer-37" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a>da1 <span class="ot">=</span> da[<span class="sc">-</span><span class="dv">1</span>,]</span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a><span class="fu">print</span>(da1) </span></code></pre></div>
<pre><code>## [1] name     id       isfemale
## &lt;0 rows&gt; (or 0-length row.names)</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>da2 <span class="ot">=</span> <span class="fu">select</span>(da,<span class="sc">-</span><span class="fu">c</span>(name,id,isfemale))</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a><span class="fu">print</span>(da2)</span></code></pre></div>
<pre><code>## data frame with 0 columns and 1 row</code></pre>
</div>
</div>
<div id="question-6" class="section level2">
<h2>Question 6</h2>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>  rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a>  (x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a>}</span></code></pre></div>
<div id="answer-38" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>,<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">as.data.frame</span>(A)</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a><span class="fu">print</span>(A)</span></code></pre></div>
<pre><code>##   V1 V2 V3
## 1  1  4  7
## 2  2  5  8
## 3  3  6  9</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a><span class="fu">sapply</span>(A,scale01) <span class="co"># every column of a data frame</span></span></code></pre></div>
<pre><code>##       V1  V2  V3
## [1,] 0.0 0.0 0.0
## [2,] 0.5 0.5 0.5
## [3,] 1.0 1.0 1.0</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>A[<span class="st">&quot;name&quot;</span>]<span class="ot">=</span><span class="fu">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a><span class="fu">print</span>(A)</span></code></pre></div>
<pre><code>##   V1 V2 V3 name
## 1  1  4  7    a
## 2  2  5  8    b
## 3  3  6  9    c</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="fu">sapply</span>(A[,<span class="fu">sapply</span>(A,is.numeric)],scale01)</span></code></pre></div>
<pre><code>##       V1  V2  V3
## [1,] 0.0 0.0 0.0
## [2,] 0.5 0.5 0.5
## [3,] 1.0 1.0 1.0</code></pre>
</div>
</div>
<div id="question-7" class="section level2">
<h2>Question 7</h2>
<p>Use <code>vapply()</code> to:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Compute the standard deviation of every column in a numeric data
frame.</p></li>
<li><p>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use <code>vapply()</code>
twice.)</p></li>
</ol>
<div id="answer-39" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="co"># Compute the standard deviation of every column</span></span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a><span class="fu">vapply</span>(iris[,<span class="sc">-</span><span class="dv">5</span>],sd,<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="co"># Compute the standard deviation of every numeric column in a mixed data frame</span></span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a><span class="fu">vapply</span>(iris[,<span class="fu">vapply</span>(iris,is.numeric,<span class="cn">TRUE</span>)],sd,<span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
##    0.8280661    0.4358663    1.7652982    0.7622377</code></pre>
</div>
</div>
<div id="question-8" class="section level2">
<h2>Question 8</h2>
<p>Consider the bivariate density <span class="math display">\[
f(x,y)\propto\binom nxy^{x+a-1}(1-y)^{n-x+b-1},\quad
x=0,1,\ldots,n,0\leq y\leq1.
\]</span> It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions
are Binomial<span class="math inline">\((n, y)\)</span> and Beta<span class="math inline">\((x + a, n − x + b)\)</span>. Use the Gibbs sampler
to generate a chain with target joint density <span class="math inline">\(f(x, y)\)</span>.</p>
<ul>
<li><p>Write an R function.</p></li>
<li><p>Write an Rcpp function.</p></li>
<li><p>Compare the computation time of the two functions with the
function “<code>microbenchmark</code>”.</p></li>
</ul>
<div id="answer-40" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a>bivariate <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">a=</span><span class="dv">1</span>,<span class="at">b=</span><span class="dv">1</span>,<span class="at">n=</span><span class="dv">10</span>,<span class="at">N=</span><span class="dv">5000</span>){</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>  X <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,N,<span class="dv">2</span>)</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>  X[<span class="dv">1</span>,] <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>)</span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N){</span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a>    y <span class="ot">=</span> X[i<span class="dv">-1</span>,<span class="dv">2</span>]</span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a>    X[i,<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb136-7"><a href="#cb136-7" tabindex="-1"></a>    x <span class="ot">=</span> X[i,<span class="dv">1</span>]</span>
<span id="cb136-8"><a href="#cb136-8" tabindex="-1"></a>    X[i,<span class="dv">2</span>] <span class="ot">=</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">-</span>x<span class="sc">+</span>b)</span>
<span id="cb136-9"><a href="#cb136-9" tabindex="-1"></a>  }</span>
<span id="cb136-10"><a href="#cb136-10" tabindex="-1"></a>  <span class="fu">return</span>(X)</span>
<span id="cb136-11"><a href="#cb136-11" tabindex="-1"></a>}</span>
<span id="cb136-12"><a href="#cb136-12" tabindex="-1"></a></span>
<span id="cb136-13"><a href="#cb136-13" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">bivariate</span>()</span>
<span id="cb136-14"><a href="#cb136-14" tabindex="-1"></a><span class="fu">plot</span>(X[,<span class="dv">1</span>],X[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="co"># Rcpp</span></span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a><span class="co"># Define function &quot;add&quot;</span></span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="at">code=</span><span class="st">&#39;</span></span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb137-5"><a href="#cb137-5" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb137-6"><a href="#cb137-6" tabindex="-1"></a></span>
<span id="cb137-7"><a href="#cb137-7" tabindex="-1"></a><span class="st">//[[Rcpp::export]]</span></span>
<span id="cb137-8"><a href="#cb137-8" tabindex="-1"></a><span class="st">NumericMatrix bivariateC(double a, double b, int n, int N) {</span></span>
<span id="cb137-9"><a href="#cb137-9" tabindex="-1"></a><span class="st">  NumericMatrix X(N,2);</span></span>
<span id="cb137-10"><a href="#cb137-10" tabindex="-1"></a><span class="st">  double x,y;</span></span>
<span id="cb137-11"><a href="#cb137-11" tabindex="-1"></a><span class="st">  X(0,0)=0;</span></span>
<span id="cb137-12"><a href="#cb137-12" tabindex="-1"></a><span class="st">  X(0,1)=0.5;</span></span>
<span id="cb137-13"><a href="#cb137-13" tabindex="-1"></a><span class="st">  for(int i=1;i&lt;N;i++){</span></span>
<span id="cb137-14"><a href="#cb137-14" tabindex="-1"></a><span class="st">    y = X(i-1,1);</span></span>
<span id="cb137-15"><a href="#cb137-15" tabindex="-1"></a><span class="st">    X(i,0) = rbinom(1,n,y)[0];</span></span>
<span id="cb137-16"><a href="#cb137-16" tabindex="-1"></a><span class="st">    x = X(i,0);</span></span>
<span id="cb137-17"><a href="#cb137-17" tabindex="-1"></a><span class="st">    X(i,1) = rbeta(1,x+a,n-x+b)[0];</span></span>
<span id="cb137-18"><a href="#cb137-18" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb137-19"><a href="#cb137-19" tabindex="-1"></a><span class="st">  return X;</span></span>
<span id="cb137-20"><a href="#cb137-20" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb137-21"><a href="#cb137-21" tabindex="-1"></a><span class="st">&#39;</span>)</span>
<span id="cb137-22"><a href="#cb137-22" tabindex="-1"></a>XC <span class="ot">=</span> <span class="fu">bivariateC</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5000</span>)</span>
<span id="cb137-23"><a href="#cb137-23" tabindex="-1"></a><span class="fu">plot</span>(XC[,<span class="dv">1</span>],XC[,<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">bivariateR=</span><span class="fu">bivariate</span>(),<span class="at">bivariateC=</span><span class="fu">bivariateC</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">5000</span>))</span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##         expr       lq   median       uq
## 1 bivariateR 19.59315 23.71785 26.39360
## 2 bivariateC  2.00930  2.10990  2.54085</code></pre>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
